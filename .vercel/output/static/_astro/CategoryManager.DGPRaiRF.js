import{j as t,Q as D,u as F,a as Q,b as u,c as o}from"./api.By0AvBr2.js";import{r}from"./index.7in8nkh5.js";function k(s){return s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")}function q(){const s=F(),[i,p]=r.useState(""),[x,m]=r.useState(""),[N,c]=r.useState(null),[l,g]=r.useState(""),[h,b]=r.useState(""),[f,a]=r.useState(""),{data:C,isLoading:j}=Q({queryKey:["categories"],queryFn:async()=>(await o.get("/categories")).data}),y=C?.data||C||[],d=u({mutationFn:e=>o.post("/admin/categories",e),onSuccess:()=>{s.invalidateQueries({queryKey:["categories"]}),p(""),m(""),a("")},onError:e=>{a(e.response?.data?.message||"Error al crear")}}),v=u({mutationFn:({id:e,...n})=>o.patch(`/admin/categories/${e}`,n),onSuccess:()=>{s.invalidateQueries({queryKey:["categories"]}),c(null),a("")}}),A=u({mutationFn:e=>o.delete(`/admin/categories/${e}`),onSuccess:()=>{s.invalidateQueries({queryKey:["categories"]}),a("")},onError:e=>{a(e.response?.data?.message||"Error al eliminar")}}),E=e=>{e.preventDefault(),i.trim()&&d.mutate({name:i.trim(),slug:k(i),description:x||void 0})},w=e=>{l.trim()&&v.mutate({id:e,name:l.trim(),description:h||void 0})},S=e=>{c(e.id),g(e.name),b(e.description||"")};return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl uppercase tracking-[-0.01em] font-bold mb-8",children:"Categorias"}),t.jsxs("form",{onSubmit:E,className:"flex flex-col md:flex-row gap-3 mb-8",children:[t.jsx("input",{value:i,onChange:e=>p(e.target.value),placeholder:"Nombre de la categoria",className:"border border-[#3C3A37]/20 bg-white px-3 py-2 text-sm font-serif focus:outline-none focus:border-[#3C3A37]/60 flex-1"}),t.jsx("input",{value:x,onChange:e=>m(e.target.value),placeholder:"Descripcion (opcional)",className:"border border-[#3C3A37]/20 bg-white px-3 py-2 text-sm font-serif focus:outline-none focus:border-[#3C3A37]/60 flex-1"}),t.jsx("button",{type:"submit",disabled:d.isPending,className:"bg-[#2B2521] text-[#F2EBD8] px-6 py-2 text-sm uppercase tracking-[-0.01em] hover:opacity-90 transition disabled:opacity-50 cursor-pointer whitespace-nowrap",children:d.isPending?"...":"Crear"})]}),f&&t.jsx("p",{className:"text-red-600 text-xs mb-4",children:f}),j?t.jsx("p",{className:"text-sm text-[#3C3A37]/50",children:"Cargando..."}):y.length===0?t.jsx("p",{className:"text-sm text-[#3C3A37]/50",children:"No hay categorias."}):t.jsx("div",{className:"bg-white border border-[#3C3A37]/10 divide-y divide-[#3C3A37]/10",children:y.map(e=>t.jsx("div",{className:"p-3 flex items-center gap-4",children:N===e.id?t.jsxs(t.Fragment,{children:[t.jsx("input",{value:l,onChange:n=>g(n.target.value),className:"border border-[#3C3A37]/20 bg-white px-2 py-1 text-sm font-serif flex-1"}),t.jsx("input",{value:h,onChange:n=>b(n.target.value),className:"border border-[#3C3A37]/20 bg-white px-2 py-1 text-sm font-serif flex-1",placeholder:"Descripcion"}),t.jsx("button",{onClick:()=>w(e.id),className:"text-[10px] uppercase px-2 py-1 bg-green-100 text-green-800 hover:bg-green-200 cursor-pointer",children:"Guardar"}),t.jsx("button",{onClick:()=>c(null),className:"text-[10px] uppercase px-2 py-1 text-[#3C3A37]/50 hover:text-[#3C3A37] cursor-pointer",children:"Cancelar"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"font-bold text-sm",children:e.name}),e.description&&t.jsx("span",{className:"text-xs text-[#3C3A37]/50 ml-2",children:e.description})]}),t.jsxs("span",{className:"text-xs text-[#3C3A37]/50",children:[e._count?.products||0," productos"]}),t.jsx("button",{onClick:()=>S(e),className:"text-[10px] uppercase px-2 py-1 border border-[#3C3A37]/20 hover:bg-[#3C3A37]/5 cursor-pointer",children:"Editar"}),t.jsx("button",{onClick:()=>{confirm(`Eliminar "${e.name}"?`)&&A.mutate(e.id)},className:"text-[10px] uppercase px-2 py-1 text-red-600 hover:bg-red-50 cursor-pointer",children:"Eliminar"})]})},e.id))})]})}function $(){return t.jsx(D,{children:t.jsx(q,{})})}export{$ as default};
